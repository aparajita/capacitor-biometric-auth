import{B as a}from"./base-B1CWJK7C.js";import{B as t,q as r,t as m,u as n}from"./index-Ky_QymkZ.js";class u extends a{constructor(){super(...arguments),this.biometryType=t.none,this.biometryTypes=[],this.biometryIsEnrolled=!1,this.deviceIsSecure=!1}async checkBiometry(){const e=this.biometryType!==t.none,i=e&&this.biometryIsEnrolled;let s="",o=r.none;return e?this.biometryIsEnrolled||(s="Biometry is not enrolled",o=r.biometryNotEnrolled):(s="No biometry is available",o=r.biometryNotAvailable),{isAvailable:i,strongBiometryIsAvailable:this.biometryIsEnrolled&&this.hasStrongBiometry(),biometryType:this.biometryType,biometryTypes:this.biometryTypes,deviceIsSecure:this.deviceIsSecure,reason:s,code:o}}hasStrongBiometry(){return this.biometryTypes.some(e=>e===t.faceId||e===t.touchId||e===t.fingerprintAuthentication)}async internalAuthenticate(e){const i=await this.checkBiometry();if(!(i.isAvailable&&confirm((e==null?void 0:e.reason)||`Authenticate with ${i.biometryTypes.map(s=>m(s)).join(" or ")}?`))){if(e!=null&&e.allowDeviceCredential){if(i.deviceIsSecure){if(confirm("Authenticate with device security?"))return;throw new n("User cancelled",r.userCancel)}else if(i.isAvailable)throw new n("Device is not secure",r.noDeviceCredential)}else if(!i.isAvailable)throw i.biometryType===t.none?new n("Biometry is not available",r.biometryNotAvailable):new n("Biometry is not enrolled",r.biometryNotEnrolled);throw new n("User cancelled",r.userCancel)}}async setBiometryType(e){if(e===void 0)return;const i=Array.isArray(e)?e:[e];if(this.biometryTypes=[],this.biometryType=t.none,i.length!==0)if(c(i))this.biometryType=i[0],this.biometryType!==t.none&&(this.biometryTypes=i);else for(const[s,o]of i.entries())l(o)&&(this.biometryType===t.none?this.biometryTypes=[]:this.biometryTypes.push(o),s===0&&(this.biometryType=o))}async setBiometryIsEnrolled(e){this.biometryIsEnrolled=e}async setDeviceIsSecure(e){this.deviceIsSecure=e}}function l(y){return Object.values(t).includes(y)}function c(y){return y.every(e=>l(e))}export{u as BiometricAuthWeb};
